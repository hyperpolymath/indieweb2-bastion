= Architecture
:project-name: IndieWeb2

== ğŸ—ï¸ Overview
IndieWeb2 is built around a **consent-first core** with pluggable modules:
- **Core**: Bastion ingress, oDNS proxies/resolvers, GraphQL DNS API.
- **Extensions**: SurrealDB provenance graph, browser extensions, CMS plugins.

== ğŸ”§ Components
- **Bastion**: Hardened ingress with Podman/Wolfi, Envoy configs, mTLS enforcement.
- **oDNS**: IPv6-native oblivious DNS with anycast + iBGP, HPKE encryption, ephemeral node rotation.
- **GraphQL DNS**: Full RR coverage, reverse DNS schemas, DNSSEC toggles, append-only audit logs.
- **SurrealDB Provenance Graph**: Identities, manifests, mentions, edges; JSON-LD export to IPFS/IPNS.
- **Browser Extension**: Consent banners, provenance badges, webmention 2.0 composer.
- **CMS Plugins**: WordPress/Ghost/Hugo integrations for auto-generating manifests and publishing to IPFS.

== ğŸ”’ Security Posture
- Zone isolation with default-deny policies.
- Hidden primaries for control-plane services.
- Tamper-evident logging with hash chaining.
- Threshold signatures for high-stakes operations.

== ğŸ“‚ Data Flow
1. Client â†’ Bastion Gateway (mTLS, rate limits, consent checks).
2. Bastion â†’ oDNS Proxy (encrypted queries).
3. Proxy â†’ Resolver (HPKE decryption, no client IP).
4. Resolver â†’ Upstream DNS (standard resolution).
5. SurrealDB â†’ Export provenance graph â†’ IPFS/IPNS snapshot.
6. Browser Extension â†’ Fetch manifests, render consent + provenance UX.

== ğŸ› ï¸ Extensibility
- CURPS policy engine compiled to WASM for portable enforcement.
- GraphQL federation adapters for HE, Cloudflare, Route53.
- SurrealDB schema extensible for new node/edge types.
- Plugins for CMS and static site generators.

